{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import axios from\"axios\";import Box from\"@material-ui/core/Box\";import CardMedia from\"@material-ui/core/CardMedia\";import Grid from\"@material-ui/core/Grid\";import Input from\"@material-ui/core/Input\";import InputLabel from\"@material-ui/core/InputLabel\";import IconButton from\"@material-ui/core/IconButton\";import AddAPhotoIcon from\"@material-ui/icons/AddAPhoto\";import Alert from\"@material-ui/lab/Alert\";import Loader from\"../components/Loader\";import{USER_DETAILS_SUCCESS}from\"../constants/userConstants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProfilePhotoUploader(){var _useState=useState(\"/images/unknown.png\"),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),uploading=_useState6[0],setUploading=_useState6[1];var dispatch=useDispatch();var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var userDetails=useSelector(function(state){return state.userDetails;});var user=userDetails.user;var uploadImageHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,formData,config,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setUploading(true);file=e.target.files[0];formData=new FormData();formData.append(\"image\",file);formData.append(\"user_id\",userInfo.id);_context.prev=5;config={headers:{\"Content-Type\":\"multipart/form-data\",Authorization:\"Bearer \".concat(userInfo.token)}};_context.next=9;return axios.post(\"/api/users/profile/image/upload/\",formData,config);case 9:_yield$axios$post=_context.sent;data=_yield$axios$post.data;setImage(data.image);setUploading(false);dispatch({type:USER_DETAILS_SUCCESS,payload:data});_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](5);setMessage(_context.t0);setUploading(false);case 20:case\"end\":return _context.stop();}}},_callee,null,[[5,16]]);}));return function uploadImageHandler(_x){return _ref.apply(this,arguments);};}();useEffect(function(){setImage(user.image);},[user]);return/*#__PURE__*/_jsxs(Box,{children:[message&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:message}),uploading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsx(CardMedia,{image:image?image:\"/images/unknown.png\",title:\"Profile Photo\",style:{position:\"relative\",height:\"0\",paddingTop:\"56.25%\",margin:\"0 auto\"},children:/*#__PURE__*/_jsx(Grid,{container:true,alignItems:\"center\",justify:\"flex-end\",style:{position:\"absolute\",bottom:\"0\",right:\"0\"},children:/*#__PURE__*/_jsx(Box,{m:2,children:/*#__PURE__*/_jsxs(InputLabel,{htmlFor:\"upload-image\",children:[/*#__PURE__*/_jsx(Input,{id:\"upload-image\",type:\"file\",name:\"upload-image\",style:{display:\"none\"},onChange:uploadImageHandler}),/*#__PURE__*/_jsx(IconButton,{style:{backgroundColor:\"#f50057\"},component:\"span\",children:/*#__PURE__*/_jsx(AddAPhotoIcon,{style:{color:\"#fff\"}})})]})})})})]});}export default ProfilePhotoUploader;","map":{"version":3,"sources":["/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/src/components/ProfilePhotoUploader.jsx"],"names":["React","useState","useEffect","useSelector","useDispatch","axios","Box","CardMedia","Grid","Input","InputLabel","IconButton","AddAPhotoIcon","Alert","Loader","USER_DETAILS_SUCCESS","ProfilePhotoUploader","image","setImage","message","setMessage","uploading","setUploading","dispatch","userLogin","state","userInfo","userDetails","user","uploadImageHandler","e","file","target","files","formData","FormData","append","id","config","headers","Authorization","token","post","data","type","payload","position","height","paddingTop","margin","bottom","right","display","backgroundColor","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport axios from \"axios\";\n\nimport Box from \"@material-ui/core/Box\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Input from \"@material-ui/core/Input\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport AddAPhotoIcon from \"@material-ui/icons/AddAPhoto\";\nimport Alert from \"@material-ui/lab/Alert\";\n\nimport Loader from \"../components/Loader\";\n\nimport { USER_DETAILS_SUCCESS } from \"../constants/userConstants\";\n\nfunction ProfilePhotoUploader() {\n  const [image, setImage] = useState(\"/images/unknown.png\");\n  const [message, setMessage] = useState();\n  const [uploading, setUploading] = useState(false);\n\n  const dispatch = useDispatch();\n\n  const userLogin = useSelector((state) => state.userLogin);\n  const { userInfo } = userLogin;\n\n  const userDetails = useSelector((state) => state.userDetails);\n  const { user } = userDetails;\n\n  const uploadImageHandler = async (e) => {\n    setUploading(true);\n\n    const file = e.target.files[0];\n    const formData = new FormData();\n\n    formData.append(\"image\", file);\n    formData.append(\"user_id\", userInfo.id);\n\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: `Bearer ${userInfo.token}`,\n        },\n      };\n\n      const { data } = await axios.post(\n        \"/api/users/profile/image/upload/\",\n        formData,\n        config\n      );\n\n      setImage(data.image);\n      setUploading(false);\n\n      dispatch({ type: USER_DETAILS_SUCCESS, payload: data });\n    } catch (error) {\n      setMessage(error);\n      setUploading(false);\n    }\n  };\n\n  useEffect(() => {\n    setImage(user.image);\n  }, [user]);\n\n  return (\n    <Box>\n      {message && <Alert severity=\"error\">{message}</Alert>}\n      {uploading ? (\n        <Loader />\n      ) : (\n        <CardMedia\n          image={image ? image : \"/images/unknown.png\"}\n          title=\"Profile Photo\"\n          style={{\n            position: \"relative\",\n            height: \"0\",\n            paddingTop: \"56.25%\",\n            margin: \"0 auto\",\n          }}\n        >\n          <Grid\n            container\n            alignItems=\"center\"\n            justify=\"flex-end\"\n            style={{ position: \"absolute\", bottom: \"0\", right: \"0\" }}\n          >\n            <Box m={2}>\n              <InputLabel htmlFor=\"upload-image\">\n                <Input\n                  id=\"upload-image\"\n                  type=\"file\"\n                  name=\"upload-image\"\n                  style={{ display: \"none\" }}\n                  onChange={uploadImageHandler}\n                />\n\n                <IconButton\n                  style={{\n                    backgroundColor: \"#f50057\",\n                  }}\n                  component=\"span\"\n                >\n                  <AddAPhotoIcon\n                    style={{\n                      color: \"#fff\",\n                    }}\n                  />\n                </IconButton>\n              </InputLabel>\n            </Box>\n          </Grid>\n        </CardMedia>\n      )}\n    </Box>\n  );\n}\n\nexport default ProfilePhotoUploader;\n"]},"metadata":{},"sourceType":"module"}