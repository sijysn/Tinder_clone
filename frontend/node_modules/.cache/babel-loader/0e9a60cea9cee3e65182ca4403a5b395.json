{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{HashLink}from\"react-router-hash-link\";import{useSelector}from\"react-redux\";import axios from\"axios\";import Box from\"@material-ui/core/Box\";import Typography from\"@material-ui/core/Typography\";import Avatar from\"@material-ui/core/Avatar\";import ReplyIcon from\"@material-ui/icons/Reply\";import{makeStyles}from\"@material-ui/core/styles\";import Loader from\"../Loader\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{iconLarge:{width:theme.spacing(10),height:theme.spacing(10)}};});function LatestMessage(_ref){var history=_ref.history,item=_ref.item;var classes=useStyles();var _useState=useState(),_useState2=_slicedToArray(_useState,2),chatUserInfo=_useState2[0],setChatUserInfo=_useState2[1];var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var config={headers:{\"content-type\":\"application/json\",Authorization:\"Bearer \".concat(userInfo.token)}};useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data,_yield$axios$get2,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(userInfo){_context.next=4;break;}history.push(\"/login\");_context.next=17;break;case 4:if(!(item.user_id==userInfo.id)){_context.next=12;break;}_context.next=7;return axios.get(\"/api/users/chatuser/\".concat(userInfo.id,\"/\").concat(item.chat_room_id,\"/\"),config);case 7:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setChatUserInfo(data);_context.next=17;break;case 12:_context.next=14;return axios.get(\"/api/users/cards/id/\".concat(item.user_id,\"/\"),config);case 14:_yield$axios$get2=_context.sent;_data=_yield$axios$get2.data;setChatUserInfo(_data);case 17:case\"end\":return _context.stop();}}},_callee);})),[history,userInfo]);return chatUserInfo?/*#__PURE__*/_jsx(HashLink,{to:\"/messages/\".concat(chatUserInfo.id,\"#latest_message\"),children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:\"row\",p:1,borderBottom:\"1px solid #dfe0df\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Avatar,{src:chatUserInfo.image,alt:\"Profile Photo\",className:classes.iconLarge}),/*#__PURE__*/_jsxs(Box,{p:2,minWidth:\"0\",children:[/*#__PURE__*/_jsx(Typography,{component:\"h2\",variant:\"h5\",children:/*#__PURE__*/_jsx(\"strong\",{children:chatUserInfo.first_name})}),/*#__PURE__*/_jsx(Typography,{component:\"p\",variant:\"h5\",color:!item.read&&item.user_id!=userInfo.id?\"textPrimary\":\"textSecondary\",children:/*#__PURE__*/_jsxs(Box,{component:\"span\",display:\"flex\",justifyContent:\"flex-start\",children:[/*#__PURE__*/_jsx(Box,{component:\"span\",children:item.user_id==userInfo.id&&/*#__PURE__*/_jsx(ReplyIcon,{})}),/*#__PURE__*/_jsx(Box,{component:\"span\",overflow:\"hidden\",textOverflow:\"ellipsis\",whiteSpace:\"nowrap\",children:item.text})]})})]})]})}):/*#__PURE__*/_jsx(Loader,{});}export default LatestMessage;","map":{"version":3,"sources":["/Users/yoshinoseiji/Programming/Tinder_clone/backend/frontend/src/components/MatchesScreen/LatestMessage.jsx"],"names":["React","useState","useEffect","HashLink","useSelector","axios","Box","Typography","Avatar","ReplyIcon","makeStyles","Loader","useStyles","theme","iconLarge","width","spacing","height","LatestMessage","history","item","classes","chatUserInfo","setChatUserInfo","userLogin","state","userInfo","config","headers","Authorization","token","push","user_id","id","get","chat_room_id","data","image","first_name","read","text"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { HashLink } from \"react-router-hash-link\";\nimport { useSelector } from \"react-redux\";\n\nimport axios from \"axios\";\n\nimport Box from \"@material-ui/core/Box\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport ReplyIcon from \"@material-ui/icons/Reply\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nimport Loader from \"../Loader\";\n\nconst useStyles = makeStyles((theme) => ({\n  iconLarge: {\n    width: theme.spacing(10),\n    height: theme.spacing(10),\n  },\n}));\n\nfunction LatestMessage({ history, item }) {\n  const classes = useStyles();\n\n  const [chatUserInfo, setChatUserInfo] = useState();\n\n  const userLogin = useSelector((state) => state.userLogin);\n  const { userInfo } = userLogin;\n\n  const config = {\n    headers: {\n      \"content-type\": \"application/json\",\n      Authorization: `Bearer ${userInfo.token}`,\n    },\n  };\n\n  useEffect(async () => {\n    if (!userInfo) {\n      history.push(\"/login\");\n    } else {\n      if (item.user_id == userInfo.id) {\n        const { data } = await axios.get(\n          `/api/users/chatuser/${userInfo.id}/${item.chat_room_id}/`,\n          config\n        );\n\n        setChatUserInfo(data);\n      } else {\n        const { data } = await axios.get(\n          `/api/users/cards/id/${item.user_id}/`,\n          config\n        );\n\n        setChatUserInfo(data);\n      }\n    }\n  }, [history, userInfo]);\n\n  return chatUserInfo ? (\n    <HashLink to={`/messages/${chatUserInfo.id}#latest_message`}>\n      <Box\n        display=\"flex\"\n        flexDirection=\"row\"\n        p={1}\n        borderBottom=\"1px solid #dfe0df\"\n        alignItems=\"center\"\n      >\n        <Avatar\n          src={chatUserInfo.image}\n          alt=\"Profile Photo\"\n          className={classes.iconLarge}\n        />\n        <Box p={2} minWidth=\"0\">\n          <Typography component=\"h2\" variant=\"h5\">\n            <strong>{chatUserInfo.first_name}</strong>\n          </Typography>\n          <Typography\n            component=\"p\"\n            variant=\"h5\"\n            color={\n              !item.read && item.user_id != userInfo.id\n                ? \"textPrimary\"\n                : \"textSecondary\"\n            }\n          >\n            <Box component=\"span\" display=\"flex\" justifyContent=\"flex-start\">\n              <Box component=\"span\">\n                {item.user_id == userInfo.id && <ReplyIcon />}\n              </Box>\n              <Box\n                component=\"span\"\n                overflow=\"hidden\"\n                textOverflow=\"ellipsis\"\n                whiteSpace=\"nowrap\"\n              >\n                {item.text}\n              </Box>\n            </Box>\n          </Typography>\n        </Box>\n      </Box>\n    </HashLink>\n  ) : (\n    <Loader />\n  );\n}\n\nexport default LatestMessage;\n"]},"metadata":{},"sourceType":"module"}